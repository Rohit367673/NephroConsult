<!DOCTYPE html>
<html>
<head>
    <title>Razorpay Test</title>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
</head>
<body>
    <h1>Razorpay Payment Test</h1>
    <button onclick="testPayment()">Test Payment</button>
    
    <script>
    async function testPayment() {
        try {
            // Test order creation
            const response = await fetch('http://localhost:4000/api/payments/test-create-order', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    amount: 2000,
                    currency: 'INR',
                    consultationType: 'Initial Consultation',
                    patientName: 'Test Patient',
                    patientEmail: 'test@example.com',
                    patientPhone: '9876543210',
                    date: '2024-12-01',
                    time: '10:00 AM'
                })
            });
            
            if (!response.ok) {
                throw new Error(`HTTP ${response.status}`);
            }
            
            const data = await response.json();
            console.log('Order created:', data);
            
            // Test Razorpay popup
            const options = {
                key: data.razorpay_key,
                amount: data.order.amount,
                currency: data.order.currency,
                name: 'NephroConsult Test',
                description: 'Test Payment',
                order_id: data.order.id,
                handler: function(response) {
                    alert('Payment successful! Payment ID: ' + response.razorpay_payment_id);
                    console.log('Payment response:', response);
                },
                prefill: {
                    name: 'Test Patient',
                    email: 'test@example.com',
                    contact: '9876543210'
                },
                theme: {
                    color: '#006f6f'
                }
            };
            
            const rzp = new Razorpay(options);
            rzp.open();
            
        } catch (error) {
            console.error('Payment test failed:', error);
            alert('Payment test failed: ' + error.message);
        }
    }
    </script>
</body>
</html>
